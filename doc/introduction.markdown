POLLUX (r2) Keyboard の紹介＆組み立てガイド

(これは基板バージョン r2 ベースの紹介です)

# 概要

![POLLUX](pollux.jpg)

POLLUX は zk-phi が設計した自作キーボードキットです。

「いつもの手癖」をそのまま活かせる、それでいて自作キーボード特有の利点も取り込んだキーボードを目指して設計しました。

具体的には以下の特徴があります：

- 少キー数 (計 44 キー) の分割キーボード

- 一般的なキーボードと同じ横ズレ配列

- １・３行目だけ１列多い７列仕様になっている (y, b を両手に置く、などができる)

- 横 18mm ・縦 17mm ピッチのコンパクト設計

- フルカラー LED に対応

- Kailh Choc (ロープロファイル) スイッチ専用

- (非リバーシブル基板で表裏を間違いづらい)

表面実装ダイオードが必須のほか、組み立て上のトラップも数箇所あるので、難易度は中〜上級者向けだと思います。

# 組み立てガイド
## オプション

以下の箇所は組み立て方に選択肢があるので、好みでカスタマイズしてください。

- Pro Micro などを覆う底板を省略することで、 2mm ほど薄くすることができます

- LED をつけることがきます (難しいです。つけなくても使えます)

## 必要な部品 (両手分)

- POLLUX 専用部品
  - 基板 2 枚
  - トップフレーム 4 枚
  - トッププレート 2 枚 [左右別]
  - ミドルフレーム上側 4 枚
  - ミドルフレーム下側 4 枚
  - ボトムプレート (穴あき) 4 枚 [左右別]
  - 底板 (穴なし) 2 枚 [左右別]

![case1](case1.jpg)
![case2](case2.jpg)

- 汎用電子部品
  - 表面実装ダイオード [1N4148w] 44 個
  - TRRS ジャック [MJ-4PP-9] 2 個
  - タクトスイッチ [TVBP06] 2 個
  - Pro Micro 2 個
  - Kailh Choc スイッチ 44 個
  - Choc スイッチ用キーキャップ 44 個
  - 光らせたい場合選択:
    - SK6812mini 44 個 [バックライトのみ]
    - SK6812mini 56 個 [バックライト＋アンダーグロー]

- ケースの組み立て材
  - M2 ナット 12 個
  - クッションゴム 10 個
  - 底板をつけるどうかによって選択:
    - M2 ネジ 15mm 12 本 [底板なし]
    - M2 ネジ 17mm 12 本 [底板あり]

- ケーブル類
  - Micro USB ケーブル
  - TRRS ケーブル

- あると便利なもの
  - コンスルー (スプリングピンヘッダ) 付き Pro Micro 1 セット
  - マスキングテープ

※コンスルーは Pro Micro を着脱可能にする部品です。 POLLUX は設計上の制約があり (ケースと干渉してしまう)、最終的な完成品にはコンスルーを使えません。したがって一度つけてしまった Pro Micro は基本的に外せません。 POLLUX は Pro Micro の裏にも部品を仕込むので、万が一これに不良があった場合、リカバリ不能になってしまいます。そこで、本番の Pro Micro を半田付けしてしまう前に、一度コンスルーをつけた動作確認用 Pro Micro を仮止めして回路に問題がないか確認することを強く推奨します。特に LED をつける場合はほぼ必須です。

※マスキングテープは部品の仮止めに使います。特に LED をつける場合はあると便利です。

## 主な爆死ポイント

組み立てる時はチェックしましょう。

- 定番
  - ハンダ不良
  - ProMicro / ダイオードの向き間違い
  - トッププレートをはめずにキースイッチをつけてしまう
  - TRRS ジャック・リセットスイッチをつける前にトッププレートをつけてしまう
  - トッププレートを割る
  - (ProMicro の MicroUSB 端子モゲ)

- POLLUX 特有
  - 基板の不要部分をカットするときに、必要な部分も破壊してしまう
  - Pro Micro の取り付け順序を間違える
  - Pro Micro の取り付け位置を間違える (作者も間違えました)

## 組み立て手順

組み立ての手順を順に紹介してゆきます。

ハマりどころはなるべくフォローしてゆくつもりで書いていますが、半田付け自体の基本的な知識、たとえば道具の持ち方・使い方、ハンダ不良の見分け方などはより詳しい資料があるはずなので、そちらで復習しておくと確実です。

### Pro Micro の準備
#### USB コネクタを補強する

Pro Micro の USB コネクタは「モゲ」やすく、幾多の自作キーボーダーたちが手痛い洗礼を受けています。

POLLUX は Pro Micro を簡単に交換できるようにする「コンスルー 」に対応していないので、ホットボンドなどで補強しておくと多少安心です。

コネクタの上や内部につけてしまわないように注意してください。

#### Pro Micro にファームウェアを書き込む

Pro Micro にファームウェアを書き込みます。

私のリポジトリからコードをダウンロード後、QMK Firmware の公式ページを参考に環境を構築します。

環境ができたら、 Pro Micro を USB で接続した上で

```terminal
make pollux/rev2:default:avrdude
```

を実行し、 Pro Micro の `GND` ピンと `RST` ピンをピンセットなどでショートすることで書き込むことができます。

初期不良の確認も兼ねて、２台（＋動作確認用１台）とも書き込んでしまいましょう。後から書き換えも可能です。

#### 動作チェック用 Pro Micro にコンスルーを立てる

動作チェック用 Pro Micro を用意する場合、 *この Pro Micro にだけ* あらかじめコンスルーを取り付けておきます。残りの２台にはまだ触りません。

向きが少しややこしいので注意して下さい：

コンスルーのプラスチック部分に空いた穴に注目します。 *穴の空いている方が「Pro Micro」側になるように、また二つのコンスルーで穴が同じ方を向くように、* コンスルーを Pro Micro に差し込みます。 *Pro Micro の「部品が乗っている面と同じ面に」* コンスルーを立てます。

斜めになってしまわないように注意しながら半田付けします。

### PCB の準備

基板は右手用・左手用で同じものを使います。スイッチの乗りそうな四角がたくさん並んでいる方が表です。

２枚の基板を同じ向きで（たとえば、表を上に）置いて、 *一方は左の、他方は右の、* 親指クラスタを落とします。同じ側を落として右手・右手や左手・左手のキーボードになってしまわないように注意してください。

力技で折ろうとすると、写真のように基板を損傷します。 *ニッパやカッターなどであらかじめ傷をつけて、* なるべく少ない力で折り取ります。切りしろ部分以外に傷をつけないように注意してください。最悪、そこを通っている配線を断線してしまうと、動作に問題が起こる場合があります (特に LED)。バリはある程度残したままでもケースに収められるようになっています。うっかり傷つけるくらいならそのままにしましょう。

### SK6812mini をつける (光らせる場合)

SK6812mini を半田付けしてゆきます。コの字の印のあるパッドが SK6812mini の Vcc になります。

基板の個体差で LED が穴に落ちてしまう場合、マスキングテープで軽く固定するとつけやすくなります。

熱で壊れやすいので、高くとも 270 度程度に抑えて半田付けします。

LED は写真の順に直列に並んでいるので、一つ目から順に半田付けし、都度次のように動作確認すると安全です：

1. 基板にコンスルー付き Pro Micro を差し込む
2. USB ケーブルを刺して PC やモバイルバッテリーから電源を供給
3. 光れば ok

Pro Micro は写真のように、基板にプリントされた枠線に合わせて差し込みます。この時点ではどちらの枠を使っても構いません。

途中でやめてもそこまでは光るので、たとえばバックライト（穴に差し込むタイプ２２灯）だけをつけてアンダーグロウ（表面につける６灯）は省略、といったこともできます。アンダーグロウの方が失敗時のリカバリは難しいです。

#### 失敗した場合

ハンダは付いているのに光らない LED がある場合、おそらく熱で壊れているので、基板のパッドを剥がさないように慎重に LED だけを外します。

穴に差し込むタイプの場合、ハンダを丁寧に除去し、そっと持ち上げれば外せます（外れない場合、無理に力を加えずに、ハンダを除去し直してください）。

表面につけるタイプは外すのが難しいです。私は、 LED の両サイドに出ている２つづつのパッドをそれぞれブリッジし、半田ごて二本で同時に温めながら持ち上げて外します。もっといい方法があれば教えて欲しいです。

### ダイオードをつける

キー数分のダイオードをつけてゆきます。表面実装品のみ対応になります。

基板に *コの字の印がある方がダイオードの目印のついている方（カソード）* です。

片方のパッドを予備ハンダし、部品を乗せて仮止めしてから、改めてハンダします。初めてで自信がない場合は、詳しい解説や動画で予習しておくと確実です。

LED をつけた場合、ここからはコテの温度を戻して構いませんが、 *高温のコテで LED に触ってしまって、せっかく取り付けた LED を破壊することがないように* 注意してください。作者は一粒破壊しました。

### リセットスイッチ、TRRS ジャックをつける

リセットスイッチ、 TRRS ジャックをこの順にとりつけます。順番を間違えても致命傷にはなりませんが、先に背の高い部品をつけてしまうと、後から背の低い部品をつけるのは若干厄介です。

基板の裏面に取り付け位置の目印があるので、ここに取り付けます。目印は二箇所ありますが、 *親指クラスターと同じ側* の目印を使用してください。 *左右で取り付け位置が逆になります* が、これが正しい状態です。

基板の表側に *飛び出した足をスレスレでカットし、あまりハンダを盛らずに取り付けてください* 。厚みが出すぎてしまうと、このあとトッププレート取り付ける時に干渉してしまい厄介です。

### 動作確認

以降の手順を終えるとリカバリの難易度が一気に上がるので、動作確認用 Pro Micro を用意してある人はここで改めて動作確認をします。

- [LED] LED が光るか
- [ダイオード] スイッチが入る予定のピンをピンセットなどで直接ショートした時、キー入力が行われるか
- [TRRS] TRRS ケーブルで左右を繋いだ時、 USB が直接刺さっていない側のキーボードからもキー入力ができるか
- [リセットスイッチ] ファームウェア書き込み時のリセット操作を、タクトスイッチで代用できるか

### ピンヘッダをつける

ここまでの動作確認ができたら、 Pro Micro 用のピンヘッダを取り付けます。この作業以降、動作確認用のコンスルー仕様 Pro Micro は接続できなくなります。

TRRS ジャック・リセットスイッチと同様に、 *表側に出た足はカットし、あまりハンダを盛らないように* 取り付けます。

ピンヘッダの穴はコンスルーに対応するためにギリギリになっているので、失敗時のリカバリがかなり難しいです。向きを間違えないようにしてください。作者は間違えて一枚諦めました。

慣れた人はピンヘッダをつけるとモジュールも一緒につけたくなってしまうと思いますが、 *Pro Micro はまだ取り付けません* 。Pro Micro のちょうど真下にある、スイッチのピンを触れなくなってしまいます。

### トッププレート・キースイッチをつける

*トッププレートにキースイッチをはめ、* 基板とドッキングします。

トッププレートを挟まずに直接スイッチを取り付けてしまうと、後からトッププートを組み込むことができなくなります。

*トッププレートは左右で微妙に形状が違います* 。基板にプリントされた四角のマークと見比べて、会う方を使ってください。

*力技でスイッチをはめようとすると、プレートは簡単に割れます* 。ピンセットなどでスイッチのツメを押さえてやるとスムーズに入ります。武力行使は禁物です。

基板からスイッチが浮いてしまわないよう、しっかり押し付けます。プレートは基板に押しつける必要はありません。基板とプレートの間に .2mm ほど隙間がある状態が正しいです。

無事ドッキングできたら、キースイッチを半田付けします。

### Pro Micro をつける

キースイッチをつけたら、いよいよピンヘッダに Pro Micro を取り付けます。Pro Micro は *部品の実装された面が内側を向きます* 。工作に慣れた人は直感に反するかもしれませんが、USB コネクタのモゲを防止するため、キーボード基板と Pro Micro 基板で部品面をサンドイッチする仕様が自作キーボードでは一般的です。

### ケースを組み立てる

図のようにケースを組み立てます・：

下から順に、底板（つける場合）、ボトムプレート２枚、ミドルプレート２枚、基板＆トッププレート、トップフレーム２枚と重なります。

*ボトムプレートも左右で微妙に形状が違います* 。並べて比べてみると、片方は Pro Micro の穴が少し広めに作られています。一方基板の方を見ると、左手の基板は Pro Micro が外形ギリギリに付いているのに対して、右手の基板の Pro Micro はやや余裕があります。これに合わせて、穴の少し広い方のボトムプレートを右手用に使用すると綺麗に組むことができます（おそらく逆にしてしまっても実用上問題ないです）。

これらを全て重ねて、ネジとナットで締めれば完成です。

クッションゴムを貼り付け、キーキャップを装着しましょう。
